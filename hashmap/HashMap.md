# Persistent HashMap

Persistent HashMap — это неизменяемый ассоциативный массив с поддержкой версий.
Реализован на основе **HAMT (Hash Array Mapped Trie)** с bitmap-индексацией и структурным шарингом.

---

## Ключевые характеристики

| Операция            | Сложность                 |
|---------------------|---------------------------|
| Get(k)              | $O(\log_{32} n)$ ~ $O(1)$ |
| Set(k, v)           | $O(\log_{32} n)$ ~ $O(1)$ |
| Delete(k)           | $O(\log_{32} n)$ ~ $O(1)$ |
| Contains(k)         | $O(\log_{32} n)$          |
| Len()               | $O(1)$                    |
| All / Keys / Values | $O(n)$                    |

Для миллиардов элементов глубина дерева не превышает 6–7 уровней,
поэтому операции фактически константные.

---

## Архитектура

### HAMT (Hash Array Mapped Trie)

- Хэш ключа разбивается на 5-битные сегменты
- Каждый уровень дерева выбирает один из 32 возможных слотов
- Используется bitmap для компактного хранения только существующих ветвей